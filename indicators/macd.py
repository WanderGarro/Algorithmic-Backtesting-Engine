from .ema import EMA
from pandas import Series

class MACD:
    """–ö–ª–∞—Å—Å –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ —Å—Ö–æ–∂–¥–µ–Ω–∏—è/—Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è —Å–∫–æ–ª—å–∑—è—â–∏—Ö —Å—Ä–µ–¥–Ω–∏—Ö (MACD)"""
    @staticmethod
    def calculate(series: Series, fast_window: int = 12, slow_window: int = 26, signal_window: int = 9) -> tuple:
        """
        –í—ã—á–∏—Å–ª—è–µ—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä MACD –∏ –µ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã.
        MACD —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Ç—Ä–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤:
            - MACD –ª–∏–Ω–∏—è: —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –±—ã—Å—Ç—Ä–æ–π –∏ –º–µ–¥–ª–µ–Ω–Ω–æ–π EMA
            - –°–∏–≥–Ω–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è: EMA –æ—Ç MACD –ª–∏–Ω–∏–∏
            - –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞: —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É MACD –∏ —Å–∏–≥–Ω–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–µ–π

        –ê—Ä–≥—É–º–µ–Ω—Ç—ã:
            series (Series): –í—Ä–µ–º–µ–Ω–Ω–æ–π —Ä—è–¥ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞. –û–±—ã—á–Ω–æ —Ü–µ–Ω—ã –∑–∞–∫—Ä—ã—Ç–∏—è.
            fast_window (int, optional): –ü–µ—Ä–∏–æ–¥ –±—ã—Å—Ç—Ä–æ–π EMA (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 12)
            slow_window (int, optional): –ü–µ—Ä–∏–æ–¥ –º–µ–¥–ª–µ–Ω–Ω–æ–π EMA (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 26)
            signal_window (int, optional): –ü–µ—Ä–∏–æ–¥ —Å–∏–≥–Ω–∞–ª—å–Ω–æ–π EMA (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 9)

        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
            tuple (macd_line, signal_line, histogram):
                macd_line (Series): –õ–∏–Ω–∏—è MACD (fast_ema - slow_ema)
                signal_line (Series): –°–∏–≥–Ω–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è (EMA –æ—Ç macd_line)
                histogram (Series): –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ MACD (macd_line - signal_line)

        –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞:
            üìä MACD Line (—Å–∏–Ω—è—è): –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É 12- –∏ 26-–ø–µ—Ä–∏–æ–¥–Ω–æ–π EMA
            üìà Signal Line (–∫—Ä–∞—Å–Ω–∞—è): 9-–ø–µ—Ä–∏–æ–¥–Ω–∞—è EMA –æ—Ç MACD Line
            üìâ Histogram (—Å—Ç–æ–ª–±–∏–∫–∏): –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É MACD –∏ Signal Line

        –û—Å–Ω–æ–≤–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã:
            üéØ –ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –ª–∏–Ω–∏–π:
                üü¢ –ü–û–ö–£–ü–ö–ê: MACD Line –ø–µ—Ä–µ—Å–µ–∫–∞–µ—Ç Signal Line —Å–Ω–∏–∑—É –≤–≤–µ—Ä—Ö
                üî¥ –ü–†–û–î–ê–ñ–ê: MACD Line –ø–µ—Ä–µ—Å–µ–∫–∞–µ—Ç Signal Line —Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑

        üìä –ü–æ–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –Ω—É–ª—è:
            –í—ã—à–µ –Ω—É–ª—è: –ë—ã—á–∏–π —Ç—Ä–µ–Ω–¥
            –ù–∏–∂–µ –Ω—É–ª—è: –ú–µ–¥–≤–µ–∂–∏–π —Ç—Ä–µ–Ω–¥

        üìà –î–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏—è (–≤–∞–∂–Ω—ã–π —Å–∏–≥–Ω–∞–ª!):
            –ë—ã—á—å—è –¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏—è: –¶–µ–Ω–∞ –¥–µ–ª–∞–µ—Ç –±–æ–ª–µ–µ –Ω–∏–∑–∫–∏–µ –º–∏–Ω–∏–º—É–º—ã, –∞ MACD - –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–µ"
            –ú–µ–¥–≤–µ–∂—å—è –¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏—è: –¶–µ–Ω–∞ –¥–µ–ª–∞–µ—Ç –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–µ –º–∞–∫—Å–∏–º—É–º—ã, –∞ MACD - –±–æ–ª–µ–µ –Ω–∏–∑–∫–∏–µ ‚Üí —Ä–∞–∑–≤–æ—Ä–æ—Ç –≤–Ω–∏–∑

        üìâ –ê–Ω–∞–ª–∏–∑ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã:
            –†–∞—Å—Ç—É—â–∏–µ —Å—Ç–æ–ª–±–∏–∫–∏: –£—Å–∏–ª–µ–Ω–∏–µ —Ç—Ä–µ–Ω–¥–∞
            –£–º–µ–Ω—å—à–∞—é—â–∏–µ—Å—è —Å—Ç–æ–ª–±–∏–∫–∏: –û—Å–ª–∞–±–ª–µ–Ω–∏–µ —Ç—Ä–µ–Ω–¥–∞
            –°–º–µ–Ω–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è: –í–æ–∑–º–æ–∂–Ω—ã–π —Ä–∞–∑–≤–æ—Ä–æ—Ç

        –£—Ä–æ–≤–Ω–∏ –ø–µ—Ä–µ–∫—É–ø–ª–µ–Ω–Ω–æ—Å—Ç–∏/–ø–µ—Ä–µ–ø—Ä–æ–¥–∞–Ω–Ω–æ—Å—Ç–∏:
            –°–∏–ª—å–Ω–∞—è –ø–µ—Ä–µ–∫—É–ø–ª–µ–Ω–Ω–æ—Å—Ç—å: MACD –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –≤—ã—à–µ –Ω—É–ª—è
            –°–∏–ª—å–Ω–∞—è –ø–µ—Ä–µ–ø—Ä–æ–¥–∞–Ω–Ω–æ—Å—Ç—å: MACD –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –Ω–∏–∂–µ –Ω—É–ª—è

        –¢–æ—Ä–≥–æ–≤—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏:
            –ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –ª–∏–Ω–∏–π - –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç–æ—Ä–≥–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã
            –î–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏—è - –æ–ø–µ—Ä–µ–∂–∞—é—â–∏–µ —Å–∏–≥–Ω–∞–ª—ã —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞
            –ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –Ω—É–ª–µ–≤–æ–π –ª–∏–Ω–∏–∏ - —Å–º–µ–Ω–∞ —Ç—Ä–µ–Ω–¥–∞
            –ê–Ω–∞–ª–∏–∑ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã - —Å–∏–ª–∞ —Ç–µ–∫—É—â–µ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è
        """
        fast_ema = EMA.calculate(series, fast_window)
        slow_ema = EMA.calculate(series, slow_window)
        macd_line = fast_ema - slow_ema
        signal_line = EMA.calculate(macd_line, signal_window)
        histogram = macd_line - signal_line
        return macd_line, signal_line, histogram