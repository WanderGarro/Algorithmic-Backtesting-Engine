{% extends 'trading/base.html' %}

{% block title %}Торговые стратегии - Торговая платформа{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <h1 class="mb-4">
            <i class="bi bi-journal-text"></i> Торговые стратегии
        </h1>
        <p class="lead">Обзор всех доступных стратегий для бэктестинга</p>
    </div>
</div>

<!-- Список стратегий -->
<div class="row g-4" id="strategies-list">
    {% for strategy_key, strategy in strategies.items %}
    <div class="col-lg-6">
        <div class="card h-100">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="card-title mb-0">{{ strategy.name }}</h5>
                <span class="badge bg-primary">{{ strategy.category }}</span>
            </div>
            <div class="card-body">
                <p class="card-text">{{ strategy.description }}</p>
                
                <h6>Параметры стратегии:</h6>
                <div class="table-responsive">
                    <table class="table table-sm table-bordered">
                        <thead>
                            <tr>
                                <th>Параметр</th>
                                <th>Описание</th>
                                <th>По умолчанию</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for param_name, param in strategy.parameters.items %}
                            <tr>
                                <td><code>{{ param_name }}</code></td>
                                <td>{{ param.description }}</td>
                                <td>{{ param.default }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                
                <div class="mt-3">
                    <strong>Рекомендации:</strong>
                    <ul class="small">
                        <li>Таймфрейм: {{ strategy.recommended_timeframe }}</li>
                        <li>Рынок: {{ strategy.recommended_market }}</li>
                        <li>Риск: 
                            <span class="badge 
                                {% if strategy.risk_level == 'Low' %}bg-success
                                {% elif strategy.risk_level == 'Medium' %}bg-warning
                                {% else %}bg-danger{% endif %}">
                                {{ strategy.risk_level }}
                            </span>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="card-footer">
                <a href="{% url 'backtest_view' %}?strategy={{ strategy_key }}" 
                   class="btn btn-primary btn-sm">
                    <i class="bi bi-play-circle"></i> Протестировать
                </a>
            </div>
        </div>
    </div>
    {% endfor %}
</div>

<!-- Сравнение стратегий -->
<div class="row mt-5">
    <div class="col-12">
        <div class="card">
            <div class="card-header bg-info text-white">
                <h5 class="card-title mb-0">
                    <i class="bi bi-bar-chart"></i> Сравнение стратегий
                </h5>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Стратегия</th>
                                <th>Сложность</th>
                                <th>Риск</th>
                                <th>Частота сделок</th>
                                <th>Рекомендация</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for strategy_key, strategy in strategies.items %}
                            <tr>
                                <td><strong>{{ strategy.name }}</strong></td>
                                <td>
                                    {% with stars=strategy.complexity %}
                                    {% for i in "12345" %}
                                        <i class="bi bi-star{% if forloop.counter <= stars %}fill{% else %}{% endif %} text-warning"></i>
                                    {% endfor %}
                                    {% endwith %}
                                </td>
                                <td>
                                    <div class="progress" style="height: 8px;">
                                        <div class="progress-bar 
                                            {% if strategy.risk_level == 'Low' %}bg-success
                                            {% elif strategy.risk_level == 'Medium' %}bg-warning
                                            {% else %}bg-danger{% endif %}" 
                                            style="width: {{ strategy.risk_percentage }}%">
                                        </div>
                                    </div>
                                </td>
                                <td>{{ strategy.trade_frequency }}</td>
                                <td>
                                    <span class="badge 
                                        {% if strategy.recommendation == 'Рекомендуется' %}bg-success
                                        {% elif strategy.recommendation == 'Умеренно' %}bg-warning
                                        {% else %}bg-secondary{% endif %}">
                                        {{ strategy.recommendation }}
                                    </span>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}